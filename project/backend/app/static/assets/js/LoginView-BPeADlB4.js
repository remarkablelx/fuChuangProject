import{e as r,c as p,a as e,b as v,n as f,f as _,w as c,v as m,t as V,g as x,h as g,i as b,j as S,d as B,o as w,u as N}from"./index-UshxQZUA.js";import{a as y}from"./index-BtuGy7By.js";import{_ as q,l as I}from"./Logo--VgbTpDB.js";const L="/assets/png/wechat-logo-B7bLky3e.png",T={class:"login-container"},U={class:"login-header"},$={class:"login-tabs"},D={class:"form-group"},M={key:0,class:"form-group"},j={key:1,class:"form-group"},z={class:"sms-input"},A=["disabled"],E={class:"footer-links"},R={__name:"LoginView",setup(F){const h=B(),t=r("password"),i=r(""),d=r(""),u=r(""),l=r(0),k=async()=>{var n;try{if((await y.post("/api/send_sms",{phone:i.value})).data.success){l.value=60;const o=setInterval(()=>{l.value--,l.value<=0&&clearInterval(o)},1e3)}}catch(s){alert(((n=s.response)==null?void 0:n.data.message)||"发送验证码失败")}},C=async()=>{var n;try{const s={phone:i.value,type:t.value};t.value==="password"?s.password=d.value:s.sms_code=u.value;const o=await y.post("/api/password_login",s);o.data.success?(await N().login(o.data.token),await h.push("/main")):alert(o.data.message)}catch(s){alert(((n=s.response)==null?void 0:n.data.message)||"登录失败")}};return(n,s)=>{const o=S("router-link");return w(),p("div",T,[e("div",U,[e("h1",null,[v(I)])]),s[8]||(s[8]=e("div",{class:"login-header"},[e("h2",null,"用户登录")],-1)),e("div",$,[e("button",{class:f(["tab",{active:t.value==="password"}]),onClick:s[0]||(s[0]=a=>t.value="password")}," 密码登录 ",2),e("button",{class:f(["tab",{active:t.value==="sms"}]),onClick:s[1]||(s[1]=a=>t.value="sms")}," 验证码登录 ",2)]),e("form",{onSubmit:x(C,["prevent"])},[e("div",D,[c(e("input",{type:"tel","onUpdate:modelValue":s[2]||(s[2]=a=>i.value=a),placeholder:"请输入手机号",required:""},null,512),[[m,i.value]])]),t.value==="password"?(w(),p("div",M,[c(e("input",{type:"password","onUpdate:modelValue":s[3]||(s[3]=a=>d.value=a),placeholder:"请输入密码",required:""},null,512),[[m,d.value]])])):_("",!0),t.value==="sms"?(w(),p("div",j,[e("div",z,[c(e("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=a=>u.value=a),placeholder:"验证码",required:""},null,512),[[m,u.value]]),e("button",{type:"button",class:"sms-btn",disabled:l.value>0,onClick:k},V(l.value?`${l.value}s`:"获取验证码"),9,A)])])):_("",!0),s[5]||(s[5]=e("button",{type:"submit",class:"submit-btn"},"立即登录",-1))],32),s[9]||(s[9]=e("div",{class:"third-login"},[e("div",{class:"divider"},"或使用以下方式登录"),e("button",{class:"wechat-login"},[e("img",{src:L,alt:"微信登录"}),g(" 微信扫码登录 ")])],-1)),e("div",E,[v(o,{to:"/forgot-password"},{default:b(()=>s[6]||(s[6]=[g("忘记密码")])),_:1}),v(o,{to:"/register"},{default:b(()=>s[7]||(s[7]=[g("注册账号")])),_:1})])])}}},K=q(R,[["__scopeId","data-v-ceda933f"]]);export{K as default};
