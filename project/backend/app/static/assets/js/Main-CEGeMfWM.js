const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/AnalysisHistory-Bh3rZR0F.js","assets/js/Logo--VgbTpDB.js","assets/js/index-UshxQZUA.js","assets/css/index-D3nDvg0c.css","assets/css/Logo-LlBiUJ3O.css","assets/js/index-BtuGy7By.js","assets/css/AnalysisHistory-6k3j53bJ.css","assets/js/TechnicalEvaluation-CG2jTuav.js","assets/css/TechnicalEvaluation-CC8ORzy9.css","assets/js/Analysis-ynH3j3QJ.js","assets/css/Analysis-C3wwnckL.css"])))=>i.map(i=>d[i]);
import{k as O,u as y,e as b,l as D,m as M,c,b as v,a as e,i as C,T as I,p as S,j as w,F as U,r as V,f as g,t as u,q as F,s as x,n as E,o as r,w as Q,x as J,y as z,z as k,A as _,B as G,_ as B}from"./index-UshxQZUA.js";import{_ as T,l as H}from"./Logo--VgbTpDB.js";import{a as R}from"./index-BtuGy7By.js";const Y=O("history",()=>{const l=y(),s=b([]),a=b(null),n=b(!1),o=b(null);return{historyItems:s,currentAnalysisId:a,isLoading:n,error:o,setCurrentAnalysisId:t=>{a.value=t},fetchHistory:async()=>{try{n.value=!0;const t=await fetch("/api/history",{headers:{Authorization:`Bearer ${l.token}`}});if(!t.ok){const{message:A}=await t.json();o.value=A||"获取历史记录失败";return}const{data:d}=await t.json();s.value=d,s.value.length>0&&(a.value=s.value[0].id),o.value=null}catch(t){o.value=t.message||"请求失败，请检查网络连接",console.error("获取历史记录失败:",t)}finally{n.value=!1}},deleteItem:async t=>{try{const d=Number(t),A=await fetch("/api/history",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.token}`},body:JSON.stringify({id:d})});if(!A.ok){const{message:m}=await A.json();o.value=m||"删除项目失败";return}s.value=s.value.filter(m=>m.id!==d),a.value===d&&(a.value=null),o.value=null}catch(d){o.value=d.message||"删除请求失败，请检查网络连接",console.error("删除操作失败:",d)}}}}),j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA+0lEQVR42u3XPQrCMBiAYbtYf65QOqlFcXLwEko9h2dxcbC9gGBBT+EdBAdtpeAdFBw+3yFTB3+wJiIJPFDokJcmtE3Fjp8c9dbIhQe/JB5qr04eYIkT8pKckKD3bPIqlpAvSVB9FOAhhWCHCDEW2EKULRaIXxBhB0EK71GAjxyCuHBvClGmb+6pGIIcvg34rwCuHbTQhmMiYIA9UoQmAsa4QHBGqDuggTluhQg9AepeExFEOaKjO2AOUVIEOpdgVliCic49EOJanFxnwBAHZJiYehF1EMCx3wIb8GGA+V8yFyvIl6zhPntcXSTIkJckwwZ9owcTe+T7yXEHdqT/B3xAAB8AAAAASUVORK5CYII=",q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA/klEQVR42u3XsQqCQByA8aYssrEmcQqiaOo1gmrsFXqSIAgayhcIkuopeoKW1gqhraXWGv59w003WIGeEnfwA/GG+1BRr2BHLke50XPgwU+Ih9K3izexwgVRQi4I0f60eBErSEpCFOMCPJwgOGKJAAvsIcoeCwRfWOIIwQleXICPCIJAmxtDlPGPz1QAQQTfBvxvAOfL6KJmPIBzLia4YwPXWIBafIoXBAfUjARwXNEWv2Kgpo0EjPCE4IahmsosYGA6wMVcuwV9QwF6hPmHUI+Y4YEdqlm+iOr2W2AD4gJy/UvmYA1JyRbOp8vVQogzooScsUMn042J3fLlcrwBYJz+9JWY1lwAAAAASUVORK5CYII=",L="/assets/png/default-avatar-DbLJzQkT.png",K={components:{logo:H},props:{activeTab:{type:String,required:!0},isCollapsed:{type:Boolean,default:!1}},data(){return{showUploadDialog:!1,selectedFile:null,uploadProgress:0,uploadStatus:null,tabs:[{id:"analysis-view",label:"分析界面"},{id:"analysis-history",label:"分析历史"},{id:"technical-evaluation",label:"技术问答"}]}},methods:{goHome(){this.$router.push("/")},triggerFileInput(){this.$refs.fileInput.click()},handleFileSelect(l){const s=l.target.files[0];if(!s)return;if(!["video/mp4","video/quicktime","video/x-msvideo"].includes(s.type)){alert("仅支持 MP4、MOV 和 AVI 格式的视频");return}if(s.size>1024*1024*1024){alert("文件大小不能超过1G");return}this.selectedFile=s,this.showUploadDialog=!0,this.uploadStatus=null,this.uploadProgress=0},performUpload(){const l=new FormData;l.append("video",this.selectedFile);const s={headers:{Authorization:`Bearer ${this.authStore.token}`}};this.uploadStatus="uploading",R.post("/api/upload",l,s).then(a=>{this.uploadStatus="success",this.historyStore.fetchHistory(),setTimeout(()=>{this.closeUploadDialog(),this.$emit("video-uploaded",a.data)},1500)}).catch(a=>{this.uploadStatus="error",console.error("上传失败:",a)})},closeUploadDialog(){this.showUploadDialog=!1,this.selectedFile=null,this.uploadProgress=0,this.uploadStatus=null},handleTabClick(l){l.id==="analysis-view"&&!this.hasHistory||this.$emit("switch-tab",l.id)}},setup(){const l=y(),s=Y();D(()=>{l.isLoggedIn&&!l.userInfo&&l.fetchUserInfo()});const a=M(()=>{var n;return((n=s.historyItems)==null?void 0:n.length)>0});return{authStore:l,historyStore:s,hasHistory:a}}},N={class:"logo"},W={class:"sidebar-header"},X={class:"control-buttons"},Z={class:"sidebar-nav"},$=["onClick"],ee={key:0,class:"upload-modal"},se={class:"modal-content"},te={class:"file-info"},oe={key:0,class:"progress-bar"},le={class:"progress-text"},ie={key:1,class:"status-success"},ae={key:2,class:"status-error"},ne={class:"modal-actions"},re=["disabled"],de={class:"username"};function ue(l,s,a,n,o,i){var p;const h=w("logo");return r(),c(U,null,[v(I,{name:"button-fade"},{default:C(()=>[a.isCollapsed?(r(),c("button",{key:0,class:"expand-btn",onClick:s[0]||(s[0]=t=>l.$emit("toggle-collapse"))},s[8]||(s[8]=[e("img",{src:j,alt:"打开侧栏"},null,-1)]))):g("",!0)]),_:1}),e("nav",{class:E(["user-sidebar",{collapsed:a.isCollapsed}])},[e("h3",N,[v(h)]),e("button",{class:"collapse-btn",onClick:s[1]||(s[1]=t=>l.$emit("toggle-collapse"))},s[9]||(s[9]=[e("img",{src:q,alt:"收起侧栏"},null,-1)])),e("div",W,[e("div",X,[e("input",{type:"file",ref:"fileInput",hidden:"",accept:"video/mp4,video/quicktime,video/x-msvideo",onChange:s[2]||(s[2]=(...t)=>i.handleFileSelect&&i.handleFileSelect(...t))},null,544),e("button",{class:"nav-item",onClick:s[3]||(s[3]=(...t)=>i.triggerFileInput&&i.triggerFileInput(...t))},s[10]||(s[10]=[e("span",null,"上传视频",-1)])),e("button",{class:"nav-item",onClick:s[4]||(s[4]=(...t)=>i.goHome&&i.goHome(...t))},s[11]||(s[11]=[e("span",null,"返回首页",-1)]))]),s[12]||(s[12]=e("hr",null,null,-1))]),e("ul",Z,[(r(!0),c(U,null,V(o.tabs,t=>(r(),c("li",{key:t.id,class:E(["nav-item",{active:a.activeTab===t.id,disabled:t.id==="analysis-view"&&!n.hasHistory}]),onClick:d=>i.handleTabClick(t)},[e("span",null,u(t.label),1)],10,$))),128))]),(r(),S(x,{to:"body"},[o.showUploadDialog?(r(),c("div",ee,[e("div",se,[s[13]||(s[13]=e("h3",null,"确认上传视频",-1)),e("div",te,[e("p",null,"文件名: "+u(o.selectedFile.name),1),e("p",null,"文件类型: "+u(o.selectedFile.type),1),e("p",null,"文件大小: "+u((o.selectedFile.size/1024/1024).toFixed(2))+"MB",1)]),o.uploadStatus==="uploading"?(r(),c("div",oe,[e("div",{class:"progress-fill",style:F({width:o.uploadProgress+"%"})},null,4),e("span",le,u(o.uploadProgress)+"%",1)])):g("",!0),o.uploadStatus==="success"?(r(),c("div",ie," 上传成功 ")):g("",!0),o.uploadStatus==="error"?(r(),c("div",ae," 上传失败，请重试 ")):g("",!0),e("div",ne,[o.uploadStatus?g("",!0):(r(),c("button",{key:0,class:"confirm-btn",onClick:s[5]||(s[5]=(...t)=>i.performUpload&&i.performUpload(...t))}," 确认上传 ")),e("button",{class:"cancel-btn",onClick:s[6]||(s[6]=(...t)=>i.closeUploadDialog&&i.closeUploadDialog(...t)),disabled:o.uploadStatus==="uploading"},u(o.uploadStatus==="uploading"?"上传中...":"取消"),9,re)])])])):g("",!0)])),e("div",{class:"user-entry",onClick:s[7]||(s[7]=t=>l.$emit("toggle-user-panel"))},[s[14]||(s[14]=e("div",{class:"user-avatar"},[e("img",{src:L,alt:"用户"})],-1)),e("span",de,u(((p=n.authStore.userInfo)==null?void 0:p.username)??"加载中..."),1)])],2)],64)}const ce=T(K,[["render",ue],["__scopeId","data-v-0542e6dd"]]),pe={props:{show:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>({name:"未命名",days:10,mobile:"未绑定",wechatBound:!1})}},emits:["close"],methods:{handleClose(){this.$emit("close")},handleBind(l){console.log(`绑定${l}`)},async handleLogout(){confirm("确定要退出登录吗？退出后将清除本机登录记录")&&(await this.$router.push("/login"),this.authStore.logout(),this.handleClose())}},setup(){return{authStore:y()}}},he={key:0,class:"user-panel-wrapper"},Ae={class:"user-panel"},ge={class:"user-header"},me={class:"user-meta"},ve={class:"settings-container"},fe={class:"settings-group"},be={class:"setting-item"},we={class:"action"},ye={class:"status"},Ce={class:"setting-item"},Ie={class:"action"},Se={class:"status"},ke={class:"action-buttons"};function _e(l,s,a,n,o,i){return r(),S(x,{to:"body"},[v(I,{name:"panel-slide"},{default:C(()=>{var h,p,t,d,A,m,P;return[a.show?(r(),c("div",he,[e("div",Ae,[e("div",{class:"panel-close",onClick:s[0]||(s[0]=(...f)=>i.handleClose&&i.handleClose(...f))},s[4]||(s[4]=[e("svg",{width:"14",height:"14",viewBox:"0 0 24 24"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)])),e("div",ge,[s[5]||(s[5]=e("div",{class:"avatar"},[e("img",{src:L,alt:"avatar"})],-1)),e("div",me,[e("h3",null,u(((h=n.authStore.userInfo)==null?void 0:h.username)??"加载中..."),1),e("p",null,"与 Paddle PingPong 共度 "+u(((p=n.authStore.userInfo)==null?void 0:p.days)??"n")+" 天",1)])]),e("div",ve,[e("section",fe,[s[8]||(s[8]=e("h4",{class:"group-title"},"账号设置",-1)),e("div",be,[s[6]||(s[6]=e("span",null,"手机号",-1)),e("div",we,[e("span",ye,u((t=n.authStore.userInfo)!=null&&t.phone?(d=n.authStore.userInfo)==null?void 0:d.phone:"未绑定"),1),e("button",{class:"bind-btn",onClick:s[1]||(s[1]=f=>i.handleBind("mobile"))},"绑定")])]),e("div",Ce,[s[7]||(s[7]=e("span",null,"微信账号",-1)),e("div",Ie,[e("span",Se,u((A=n.authStore.userInfo)!=null&&A.weixin?(m=n.authStore.userInfo)==null?void 0:m.weixin:"未绑定"),1),e("button",{class:"bind-btn",onClick:s[2]||(s[2]=f=>i.handleBind("wechat"))},u((P=n.authStore.userInfo)!=null&&P.weixin?"解绑":"绑定"),1)])])]),s[10]||(s[10]=e("section",{class:"settings-group"},[e("h4",{class:"group-title"},"帮助与反馈"),e("div",{class:"setting-item link-item"},[e("span",null,"使用帮助"),e("span",{class:"arrow"},"›")]),e("div",{class:"setting-item link-item"},[e("span",null,"意见反馈"),e("span",{class:"arrow"},"›")])],-1)),s[11]||(s[11]=e("section",{class:"settings-group"},[e("h4",{class:"group-title"},"关于 Paddle PingPong"),e("div",{class:"setting-item link-item"},[e("span",null,"服务协议"),e("span",{class:"arrow"},"›")]),e("div",{class:"setting-item link-item"},[e("span",null,"隐私协议"),e("span",{class:"arrow"},"›")]),e("div",{class:"setting-item link-item"},[e("span",null,"开源条款"),e("span",{class:"arrow"},"›")])],-1)),s[12]||(s[12]=e("section",{class:"settings-group"},[e("h4",{class:"group-title"},"百度飞浆大模型版本"),e("div",{class:"setting-item"},[e("span",null,"当前版本"),e("span",{class:"version"},"V0.1.4")]),e("div",{class:"setting-item link-item"},[e("span",null,"模型介绍"),e("span",{class:"arrow"},"›")])],-1)),e("div",ke,[e("button",{class:"logout-btn",onClick:s[3]||(s[3]=(...f)=>i.handleLogout&&i.handleLogout(...f))},"退出登录"),s[9]||(s[9]=e("button",{class:"delete-account"},"注销账号",-1))])])])])):g("",!0)]}),_:1})])}const Be=T(pe,[["render",_e],["__scopeId","data-v-02188b7b"]]),Te=k(_(()=>B(()=>import("./AnalysisHistory-Bh3rZR0F.js"),__vite__mapDeps([0,1,2,3,4,5,6])))),Pe=k(_(()=>B(()=>import("./TechnicalEvaluation-CG2jTuav.js"),__vite__mapDeps([7,2,3,1,4,8])))),Ue=k(_(()=>B(()=>import("./Analysis-ynH3j3QJ.js"),__vite__mapDeps([9,2,3,1,4,5,10])))),Ee={components:{SidebarNav:ce,UserPanel:Be},data(){return{isMobile:!1,activeTab:"analysis-history",showUserPanel:!1,isSidebarCollapsed:!1,componentsMap:z({"analysis-history":Te,"technical-evaluation":Pe,"analysis-view":Ue})}},computed:{activeComponent(){return this.componentsMap[this.activeTab]},sidebarWidth(){return this.isMobile?"0":this.isSidebarCollapsed?"20px":"240px"}},mounted(){this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeUnmount(){window.removeEventListener("resize",this.checkIsMobile)},methods:{switchTab(l){this.activeTab=l},switchToAnalysisView(){this.activeTab="analysis-view"},toggleUserPanel(){this.showUserPanel=!this.showUserPanel},handleLogout(){localStorage.removeItem("mockAuth"),localStorage.removeItem("mockUser"),this.$router.push("/login")},checkIsMobile(){this.isMobile=window.innerWidth<=768,this.isMobile&&!this.isSidebarCollapsed&&(this.isSidebarCollapsed=!0)}}},Fe={class:"user-container"};function xe(l,s,a,n,o,i){const h=w("SidebarNav"),p=w("UserPanel");return r(),c("div",Fe,[v(h,{"active-tab":o.activeTab,"is-collapsed":o.isSidebarCollapsed,onSwitchTab:i.switchTab,onToggleUserPanel:i.toggleUserPanel,onToggleCollapse:s[0]||(s[0]=t=>o.isSidebarCollapsed=!o.isSidebarCollapsed)},null,8,["active-tab","is-collapsed","onSwitchTab","onToggleUserPanel"]),e("main",{class:"user-main",style:F({marginLeft:i.sidebarWidth})},[v(I,{name:"fade-slide",mode:"out-in"},{default:C(()=>[(r(),S(G(i.activeComponent),{onCheck:i.switchToAnalysisView},null,40,["onCheck"]))]),_:1}),v(p,{show:o.showUserPanel,"user-info":l.currentUser,onClose:i.toggleUserPanel,onLogout:i.handleLogout},null,8,["show","user-info","onClose","onLogout"])],4),Q(e("div",{class:"sidebar-mask",onClick:s[1]||(s[1]=t=>o.isSidebarCollapsed=!0)},null,512),[[J,o.isMobile&&!o.isSidebarCollapsed]])])}const Le=T(Ee,[["render",xe],["__scopeId","data-v-efd75d90"]]),Ve=Object.freeze(Object.defineProperty({__proto__:null,default:Le},Symbol.toStringTag,{value:"Module"}));export{Ve as M,Y as u};
